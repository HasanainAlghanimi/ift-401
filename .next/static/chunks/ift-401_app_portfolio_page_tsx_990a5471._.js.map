{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hasan/ift-401/app/portfolio/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useDemoSession } from '@/lib/useDemoSession';\r\n\r\ntype Position = { symbol: string; qty: number; avgPrice: number };\r\ntype Portfolio = { cash: number; positions: Position[] };\r\n\r\nconst STARTING_CASH = 100_000;\r\n\r\n// helpers\r\nfunction readJSON<T>(key: string, fallback: T): T {\r\n  try { return JSON.parse(localStorage.getItem(key) || 'null') ?? fallback; }\r\n  catch { return fallback; }\r\n}\r\nfunction ensurePortfolio(): Portfolio {\r\n  const p = readJSON<Portfolio>('demo_portfolio', { cash: STARTING_CASH, positions: [] });\r\n  if (typeof p.cash !== 'number' || !Array.isArray(p.positions)) return { cash: STARTING_CASH, positions: [] };\r\n  return p;\r\n}\r\nfunction getQuote(symbol: string): number {\r\n  const s = symbol || 'AAPL';\r\n  const seed = [...s].reduce((a, c) => a + c.charCodeAt(0), 0);\r\n  const base = 50 + (seed % 400);\r\n  const jitter = (Date.now() / 1000) % 10;\r\n  return Math.round((base + jitter) * 100) / 100;\r\n}\r\nconst money = (n: number) => `$${n.toLocaleString(undefined, { maximumFractionDigits: 2 })}`;\r\n\r\nexport default function PortfolioSimplePage() {\r\n  const router = useRouter();\r\n  const { isLoggedIn } = useDemoSession();\r\n\r\n  // mount/auth gates first (avoid hook-order issues)\r\n  const [mounted, setMounted] = useState(false);\r\n  const [hasSession, setHasSession] = useState<boolean | null>(null);\r\n  useEffect(() => {\r\n    setMounted(true);\r\n    try { setHasSession(!!localStorage.getItem('demo_session')); }\r\n    catch { setHasSession(false); }\r\n  }, []);\r\n  const authed = isLoggedIn || !!hasSession;\r\n\r\n  // data\r\n  const [portfolio, setPortfolio] = useState<Portfolio>({ cash: STARTING_CASH, positions: [] });\r\n\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n    setPortfolio(ensurePortfolio());\r\n  }, [mounted]);\r\n\r\n  // compute unrealized P/L per position (simple mark from getQuote)\r\n  const rows = useMemo(() => {\r\n    return portfolio.positions.map(p => {\r\n      const mark = getQuote(p.symbol);\r\n      const pnl = (mark - p.avgPrice) * p.qty;\r\n      return { symbol: p.symbol, qty: p.qty, pnl };\r\n    });\r\n  }, [portfolio.positions]);\r\n\r\n  const totalPnL = useMemo(() => rows.reduce((a, r) => a + r.pnl, 0), [rows]);\r\n\r\n  // redirect if not authed once known\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n    if (!authed) router.replace('/signin');\r\n  }, [mounted, authed, router]);\r\n\r\n  if (!mounted || !authed) return null;\r\n\r\n  return (\r\n    <main className=\"container\" style={{ paddingTop: 24, paddingBottom: 24 }}>\r\n      <div className=\"pageheader\">\r\n        <div>\r\n          <h1 className=\"stocks__title\">Portfolio</h1>\r\n          <p className=\"stocks__sub\">Your current holdings & unrealized P/L.</p>\r\n        </div>\r\n        <div className=\"header-actions\">\r\n          <span className={`badge ${totalPnL >= 0 ? 'badge--ok' : ''}`}>\r\n            Total Unrealized P/L:&nbsp;\r\n            <strong className={totalPnL >= 0 ? 'num is-up' : 'num is-down'}>\r\n              {totalPnL >= 0 ? '+' : ''}{totalPnL.toFixed(2)}\r\n            </strong>\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      <section className=\"card portfoliotable\">\r\n  {/* header */}\r\n  <div className=\"portfoliotable__head\">\r\n    <div className=\"portfoliotable__h left\">Symbol</div>\r\n    <div className=\"portfoliotable__h center\">Qty</div>\r\n    <div className=\"portfoliotable__h center\">Unrealized P/L</div>\r\n    <div />\r\n  </div>\r\n\r\n  {/* body */}\r\n  <ul className=\"portfoliotable__body\">\r\n    {rows.map(r => (\r\n      <li key={r.symbol} className=\"portfoliotable__row\">\r\n        <div className=\"portfoliotable__symbol\">{r.symbol}</div>\r\n        <div className=\"portfoliotable__qty\">{r.qty}</div>\r\n        <div className={`portfoliotable__pnl ${r.pnl >= 0 ? 'is-up' : 'is-down'}`}>\r\n          {r.pnl >= 0 ? '+' : ''}{r.pnl.toFixed(2)}\r\n        </div>\r\n        <div className=\"row__actions\">\r\n          <button className=\"iconbtn\" title=\"Trade\" onClick={() => router.push('/trade')}>+</button>\r\n        </div>\r\n      </li>\r\n    ))}\r\n  </ul>\r\n</section>\r\n</main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}