{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hasan/ift-401/app/trade/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useDemoSession } from '@/lib/useDemoSession';\r\nimport { supabase } from '@/lib/supabaseClient';\r\n\r\ntype Stock = {\r\n  ticker_id: number;\r\n  symbol: string;\r\n  company_name: string | null;\r\n};\r\n\r\ntype Account = {\r\n  account_id: number;\r\n  balance: number;\r\n};\r\n\r\ntype Side = 'BUY' | 'SELL';\r\ntype OrderType = 'MARKET';\r\n\r\ntype Position = { symbol: string; qty: number; avgPrice: number };\r\ntype Portfolio = { cash: number; positions: Position[] };\r\n\r\ntype UiOrder = {\r\n  id: string;\r\n  time: string;\r\n  symbol: string;\r\n  side: Side;\r\n  type: OrderType;\r\n  qty: number;\r\n  fillPrice: number;\r\n};\r\n\r\nconst STARTING_CASH = 10_000;\r\nconst ORDER_TYPE: OrderType = 'MARKET';\r\n\r\n// localStorage helpers\r\nfunction readJSON<T>(key: string, fallback: T): T {\r\n  try {\r\n    return JSON.parse(localStorage.getItem(key) || 'null') ?? fallback;\r\n  } catch {\r\n    return fallback;\r\n  }\r\n}\r\nfunction writeJSON(key: string, value: unknown) {\r\n  localStorage.setItem(key, JSON.stringify(value));\r\n}\r\nfunction ensurePortfolio(): Portfolio {\r\n  const p = readJSON<Portfolio>('demo_portfolio', {\r\n    cash: STARTING_CASH,\r\n    positions: [],\r\n  });\r\n  if (typeof p.cash !== 'number' || !Array.isArray(p.positions)) {\r\n    return { cash: STARTING_CASH, positions: [] };\r\n  }\r\n  return p;\r\n}\r\nconst fmt = (n: number) =>\r\n  `$${n.toLocaleString(undefined, { maximumFractionDigits: 2 })}`;\r\n\r\n/** Helpers for market-hours check (America/New_York) */\r\nfunction getNowInET() {\r\n  const now = new Date();\r\n  const fmt = new Intl.DateTimeFormat('en-US', {\r\n    timeZone: 'America/New_York',\r\n    year: 'numeric',\r\n    month: '2-digit',\r\n    day: '2-digit',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    second: '2-digit',\r\n    weekday: 'short',\r\n    hour12: false,\r\n  });\r\n\r\n  const parts = fmt.formatToParts(now);\r\n  const map: Record<string, string> = {};\r\n  for (const p of parts) {\r\n    if (p.type !== 'literal') map[p.type] = p.value;\r\n  }\r\n\r\n  const date = `${map.year}-${map.month}-${map.day}`;\r\n  const time = `${map.hour}:${map.minute}:${map.second}`;\r\n  const weekdayLabel = map.weekday; // \"Mon\", \"Tue\", ... \r\n\r\n  const weekdayMap: Record<string, number> = {\r\n    Sun: 7,\r\n    Mon: 1,\r\n    Tue: 2,\r\n    Wed: 3,\r\n    Thu: 4,\r\n    Fri: 5,\r\n    Sat: 6,\r\n  };\r\n\r\n  const dayOfWeek = weekdayMap[weekdayLabel] ?? 7;\r\n  const hour = Number(map.hour);\r\n  const minute = Number(map.minute);\r\n\r\n  return { date, time, dayOfWeek, hour, minute };\r\n}\r\n\r\nfunction timeToMinutes(t: string | null | undefined): number | null {\r\n  if (!t) return null;\r\n  const [h, m, s] = t.split(':').map((x) => Number(x));\r\n  if (Number.isNaN(h) || Number.isNaN(m)) return null;\r\n  return h * 60 + m + (Number.isNaN(s) ? 0 : s / 60);\r\n}\r\n\r\n/** ðŸ”¹ HELPERS TO WRITE TO position TABLE */\r\nasync function upsertPositionRow(\r\n  accountId: number,\r\n  tickerId: number,\r\n  side: Side,\r\n  qty: number,\r\n  price: number\r\n) {\r\n  try {\r\n    // 1) Load any existing position row for this account & ticker\r\n    const { data: existing, error: posErr } = await supabase\r\n      .from('position')\r\n      .select('position_id, quantity, average_cost')\r\n      .eq('account_id', accountId)\r\n      .eq('ticker_id', tickerId)\r\n      .maybeSingle();\r\n\r\n    if (posErr) {\r\n      console.error('position lookup error:', posErr);\r\n      return;\r\n    }\r\n\r\n    const nowIso = new Date().toISOString();\r\n\r\n    // No existing row\r\n    if (!existing) {\r\n      if (side === 'SELL') {\r\n        // Shouldn't really happen because you already validated quantity,\r\n        // but don't create a negative position.\r\n        console.warn('SELL with no existing position, skipping position insert');\r\n        return;\r\n      }\r\n\r\n      // BUY â†’ insert new position row\r\n      const { error: insertErr } = await supabase.from('position').insert({\r\n        account_id: accountId,\r\n        ticker_id: tickerId,\r\n        quantity: qty,\r\n        average_cost: price,\r\n        current_value: price * qty,\r\n        unrealized_pl: 0,\r\n        realized_pl: 0,\r\n        last_updated: nowIso,\r\n      });\r\n\r\n      if (insertErr) {\r\n        console.error('position insert error:', insertErr);\r\n      }\r\n      return;\r\n    }\r\n\r\n    // There *is* an existing row\r\n    const oldQty = Number((existing as any).quantity) || 0;\r\n    const oldCost = Number((existing as any).average_cost) || 0;\r\n\r\n    let newQty = oldQty;\r\n    let newAvgCost = oldCost;\r\n\r\n    if (side === 'BUY') {\r\n      newQty = oldQty + qty;\r\n      newAvgCost =\r\n        newQty > 0\r\n          ? (oldCost * oldQty + price * qty) / newQty\r\n          : price;\r\n    } else {\r\n      // SELL\r\n      newQty = oldQty - qty;\r\n      if (newQty < 0) {\r\n        console.warn('SELL would result in negative position, skipping update');\r\n        return;\r\n      }\r\n      // keep same avg cost on sell (realized P/L could be tracked separately)\r\n    }\r\n\r\n    if (newQty === 0) {\r\n      // Close the position: delete the row\r\n      const { error: delErr } = await supabase\r\n        .from('position')\r\n        .delete()\r\n        .eq('position_id', (existing as any).position_id);\r\n\r\n      if (delErr) {\r\n        console.error('position delete error:', delErr);\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Update existing row\r\n    const { error: updateErr } = await supabase\r\n      .from('position')\r\n      .update({\r\n        quantity: newQty,\r\n        average_cost: newAvgCost,\r\n        current_value: newQty * price,\r\n        last_updated: nowIso,\r\n      })\r\n      .eq('position_id', (existing as any).position_id);\r\n\r\n    if (updateErr) {\r\n      console.error('position update error:', updateErr);\r\n    }\r\n  } catch (e) {\r\n    console.error('upsertPositionRow unexpected error:', e);\r\n  }\r\n}\r\n\r\nexport default function TradePage() {\r\n  const router = useRouter();\r\n  const { isLoggedIn } = useDemoSession();\r\n\r\n  // auth / mount gates\r\n  const [mounted, setMounted] = useState(false);\r\n  const [hasSession, setHasSession] = useState<boolean | null>(null);\r\n  useEffect(() => {\r\n    setMounted(true);\r\n    try {\r\n      setHasSession(!!localStorage.getItem('demo_session'));\r\n    } catch {\r\n      setHasSession(false);\r\n    }\r\n  }, []);\r\n  const authed = isLoggedIn || !!hasSession;\r\n\r\n  // DB state\r\n  const [stocks, setStocks] = useState<Stock[]>([]);\r\n  const [account, setAccount] = useState<Account | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [loadError, setLoadError] = useState<string | null>(null);\r\n\r\n  // quote\r\n  const [quote, setQuote] = useState<number | null>(null);\r\n  const [quoteLoading, setQuoteLoading] = useState(false);\r\n\r\n  // ticket state\r\n  const [symbol, setSymbol] = useState('');\r\n  const [qty, setQty] = useState<number>(1);\r\n  const [side, setSide] = useState<Side>('BUY');\r\n  const [message, setMessage] = useState<string>('');\r\n\r\n  // local UI portfolio + orders\r\n  const [portfolio, setPortfolio] = useState<Portfolio>({\r\n    cash: STARTING_CASH,\r\n    positions: [],\r\n  });\r\n  const [orders, setOrders] = useState<UiOrder[]>([]);\r\n\r\n  // market-hours / holiday gating\r\n  const [isClosed, setIsClosed] = useState<boolean>(false);\r\n  const [marketStatusMsg, setMarketStatusMsg] = useState<string | null>(null);\r\n\r\n  // load local portfolio + orders once mounted\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n    setPortfolio(ensurePortfolio());\r\n    setOrders(readJSON<UiOrder[]>('demo_orders', []));\r\n  }, [mounted]);\r\n\r\n  // redirect if not authed\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n    if (!authed) router.replace('/signin');\r\n  }, [mounted, authed, router]);\r\n\r\n  // load tickers + account for *current user_id*\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n\r\n    const init = async () => {\r\n      setLoading(true);\r\n      setLoadError(null);\r\n\r\n      // 0) read user_id OR email from demo_session in localStorage\r\n      let demoUserId: number | null = null;\r\n      let sessionEmail: string | null = null;\r\n\r\n      try {\r\n        const raw = localStorage.getItem('demo_session');\r\n        if (raw) {\r\n          const obj = JSON.parse(raw);\r\n\r\n          // if your login ever stores a numeric user_id, use it directly\r\n          if (typeof obj.user_id === 'number') {\r\n            demoUserId = obj.user_id;\r\n          } else if (typeof obj.id === 'number') {\r\n            demoUserId = obj.id;\r\n          }\r\n\r\n          // from your screenshot, you currently have: { email, remember, role }\r\n          if (typeof obj.email === 'string') {\r\n            sessionEmail = obj.email;\r\n          }\r\n        }\r\n      } catch {\r\n        /* ignore */\r\n      }\r\n\r\n      // If we didn't get a numeric user id but we *do* have an email in the session,\r\n      // resolve user_id from the users table.\r\n      if (!demoUserId && sessionEmail) {\r\n        const { data: userRow, error: userErr } = await supabase\r\n          .from('users')\r\n          .select('user_id')\r\n          .eq('email', sessionEmail)\r\n          .maybeSingle();\r\n\r\n        if (userErr) {\r\n          console.error('Failed to resolve user id from email:', userErr);\r\n        } else if (userRow && (userRow as any).user_id != null) {\r\n          demoUserId = Number((userRow as any).user_id);\r\n        }\r\n      }\r\n\r\n      if (!demoUserId) {\r\n        setLoadError(\r\n          'Could not determine logged-in user id. Check demo_session and users table.'\r\n        );\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // 1) load tickers\r\n      const { data: tickerRows, error: tickerError } = await supabase\r\n        .from('ticker')\r\n        .select('ticker_id, symbol, company_name')\r\n        .eq('is_active', true)\r\n        .order('symbol', { ascending: true });\r\n\r\n      if (tickerError) {\r\n        console.error(tickerError);\r\n        setLoadError('Failed to load tickers.');\r\n      } else if (tickerRows && tickerRows.length > 0) {\r\n        setStocks(tickerRows as Stock[]);\r\n        setSymbol((prev) => prev || tickerRows[0].symbol);\r\n      } else {\r\n        setStocks([]);\r\n        setSymbol('');\r\n      }\r\n\r\n      // 2) load account row for this user_id\r\n      const { data: acct, error: acctErr } = await supabase\r\n        .from('account')\r\n        .select('account_id, balance')\r\n        .eq('user_id', demoUserId)\r\n        .maybeSingle();\r\n\r\n      if (acctErr || !acct) {\r\n        console.error(acctErr);\r\n        setLoadError(\r\n          'Failed to load trading account for this user. Make sure there is an account row with this user_id.'\r\n        );\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const acctBalance = Number((acct as any).balance);\r\n      setAccount({\r\n        account_id: (acct as any).account_id,\r\n        balance: acctBalance,\r\n      });\r\n\r\n      setPortfolio((prev) => ({\r\n        ...prev,\r\n        cash: acctBalance,\r\n      }));\r\n\r\n      setLoading(false);\r\n    };\r\n\r\n    void init();\r\n  }, [mounted]);\r\n\r\n  // load latest close from pricebar whenever symbol changes\r\n  useEffect(() => {\r\n    const loadQuote = async () => {\r\n      if (!symbol || stocks.length === 0) {\r\n        setQuote(null);\r\n        return;\r\n      }\r\n\r\n      const stock = stocks.find((st) => st.symbol === symbol);\r\n      if (!stock) {\r\n        setQuote(null);\r\n        return;\r\n      }\r\n\r\n      setQuoteLoading(true);\r\n\r\n      const { data, error } = await supabase\r\n        .from('pricebar')\r\n        .select('close, bar_date, bar_time, time_interval')\r\n        .eq('ticker_id', stock.ticker_id)\r\n        .eq('time_interval', 'daily')\r\n        .order('bar_date', { ascending: false })\r\n        .order('bar_time', { ascending: false })\r\n        .limit(1)\r\n        .maybeSingle();\r\n\r\n      if (error) {\r\n        console.error(error);\r\n        setQuote(null);\r\n      } else if (data && (data as any).close != null) {\r\n        setQuote(Number((data as any).close));\r\n      } else {\r\n        setQuote(null);\r\n      }\r\n\r\n      setQuoteLoading(false);\r\n    };\r\n\r\n    void loadQuote();\r\n  }, [symbol, stocks]);\r\n\r\n  const posMap = useMemo(() => {\r\n    const map = new Map<string, Position>();\r\n    portfolio.positions.forEach((p) => map.set(p.symbol, p));\r\n    return map;\r\n  }, [portfolio.positions]);\r\n\r\n  /** Market-hours + holiday gating effect */\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n\r\n    const checkMarket = async () => {\r\n      try {\r\n        const { date, time, dayOfWeek, hour, minute } = getNowInET();\r\n        const nowMinutes = hour * 60 + minute;\r\n\r\n        // 1) Holiday / calendar check\r\n        const { data: calRow, error: calErr } = await supabase\r\n          .from('marketcalendar')\r\n          .select('holiday_name, market_status')\r\n          .eq('date', date)\r\n          .maybeSingle();\r\n\r\n        if (calErr) {\r\n          console.error('marketcalendar lookup error:', calErr);\r\n        }\r\n\r\n        if (calRow && calRow.market_status === 'Closed') {\r\n          setIsClosed(true);\r\n          setMarketStatusMsg(\r\n            calRow.holiday_name\r\n              ? `Market closed today for ${calRow.holiday_name}.`\r\n              : 'Market closed today.'\r\n          );\r\n          return;\r\n        }\r\n\r\n        // 2) Regular hours from markethours table\r\n        const { data: hoursRow, error: hoursErr } = await supabase\r\n          .from('markethours')\r\n          .select(\r\n            'open_time, close_time, pre_market_start, after_hours_end, is_active, effective_date'\r\n          )\r\n          .eq('day_of_week', dayOfWeek)\r\n          .eq('is_active', true)\r\n          .lte('effective_date', date)\r\n          .order('effective_date', { ascending: false })\r\n          .limit(1)\r\n          .maybeSingle();\r\n\r\n        if (hoursErr) {\r\n          console.error('markethours lookup error:', hoursErr);\r\n          setIsClosed(true);\r\n          setMarketStatusMsg('Could not load market hours configuration.');\r\n          return;\r\n        }\r\n\r\n        if (!hoursRow) {\r\n          // weekend or no schedule\r\n          setIsClosed(true);\r\n          setMarketStatusMsg('Market is closed today.');\r\n          return;\r\n        }\r\n\r\n        const startMinutes =\r\n          timeToMinutes(hoursRow.pre_market_start) ??\r\n          timeToMinutes(hoursRow.open_time);\r\n        const endMinutes =\r\n          timeToMinutes(hoursRow.after_hours_end) ??\r\n          timeToMinutes(hoursRow.close_time);\r\n\r\n        if (\r\n          startMinutes == null ||\r\n          endMinutes == null ||\r\n          nowMinutes < startMinutes ||\r\n          nowMinutes > endMinutes\r\n        ) {\r\n          setIsClosed(true);\r\n          setMarketStatusMsg(\r\n            'Trading is currently outside configured market hours.'\r\n          );\r\n        } else {\r\n          setIsClosed(false);\r\n          setMarketStatusMsg(null);\r\n        }\r\n      } catch (err) {\r\n        console.error('market hours check error', err);\r\n        setIsClosed(false);\r\n        setMarketStatusMsg(null);\r\n      }\r\n    };\r\n\r\n    void checkMarket();\r\n  }, [mounted]);\r\n\r\n  function updatePortfolio(\r\n    newCash: number,\r\n    s: string,\r\n    fillPrice: number,\r\n    qtyDelta: number\r\n  ) {\r\n    setPortfolio((prev) => {\r\n      const next: Portfolio = {\r\n        cash: newCash,\r\n        positions: prev.positions.map((p) => ({ ...p })),\r\n      };\r\n\r\n      const existing = next.positions.find((p) => p.symbol === s);\r\n      if (!existing) {\r\n        if (qtyDelta > 0) {\r\n          next.positions.push({\r\n            symbol: s,\r\n            qty: qtyDelta,\r\n            avgPrice: fillPrice,\r\n          });\r\n        }\r\n      } else {\r\n        const newQty = existing.qty + qtyDelta;\r\n        if (newQty <= 0) {\r\n          next.positions = next.positions.filter((p) => p.symbol !== s);\r\n        } else if (qtyDelta > 0) {\r\n          existing.avgPrice =\r\n            (existing.avgPrice * existing.qty + fillPrice * qtyDelta) / newQty;\r\n          existing.qty = newQty;\r\n        } else {\r\n          existing.qty = newQty;\r\n        }\r\n      }\r\n\r\n      writeJSON('demo_portfolio', next);\r\n      return next;\r\n    });\r\n  }\r\n\r\n  async function placeOrder() {\r\n    if (!account) {\r\n      setMessage('Trading account not loaded.');\r\n      return;\r\n    }\r\n\r\n    if (isClosed) {\r\n      setMessage(\r\n        marketStatusMsg ||\r\n          'Trading is currently closed. Please return during market hours.'\r\n      );\r\n      return;\r\n    }\r\n\r\n    const s = symbol.trim().toUpperCase();\r\n    if (!s) {\r\n      setMessage('Select a symbol.');\r\n      return;\r\n    }\r\n    if (!Number.isFinite(qty) || qty <= 0) {\r\n      setMessage('Quantity must be a positive number.');\r\n      return;\r\n    }\r\n    if (quote == null || !Number.isFinite(quote) || quote <= 0) {\r\n      setMessage('No price data available for this symbol.');\r\n      return;\r\n    }\r\n\r\n    const stock = stocks.find((st) => st.symbol === s);\r\n    if (!stock) {\r\n      setMessage('That symbol is not available to trade.');\r\n      return;\r\n    }\r\n\r\n    const px = quote;\r\n    const amt = Number((px * qty).toFixed(2));\r\n    const currentBalance = Number(account.balance);\r\n\r\n    if (side === 'BUY' && amt > currentBalance) {\r\n      setMessage(`Insufficient funds. You have ${fmt(currentBalance)}.`);\r\n      return;\r\n    }\r\n\r\n    if (side === 'SELL') {\r\n      const have = posMap.get(s)?.qty ?? 0;\r\n      if (qty > have) {\r\n        setMessage(`You only have ${have} ${s} to sell.`);\r\n        return;\r\n      }\r\n    }\r\n\r\n    try {\r\n      setMessage('Submitting order...');\r\n\r\n      // 1) insert into orders\r\n      const { data: orderRow, error: orderError } = await supabase\r\n        .from('orders')\r\n        .insert({\r\n          account_id: account.account_id,\r\n          ticker_id: stock.ticker_id,\r\n          order_type: 'Market', // matches your CHECK constraint\r\n          side: side === 'BUY' ? 'Buy' : 'Sell',\r\n          quantity: qty,\r\n          price: px,\r\n          status: 'FILLED',\r\n          order_date: new Date().toISOString(),\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (orderError || !orderRow) {\r\n        console.error('Order insert error:', orderError);\r\n        setMessage(\r\n          `Could not place order: ${orderError?.message ?? 'Unknown error'}`\r\n        );\r\n        return;\r\n      }\r\n\r\n      // 2) insert into trade\r\n      const { error: tradeError } = await supabase.from('trade').insert({\r\n        order_id: (orderRow as any).order_id,\r\n        ticker_id: stock.ticker_id,\r\n        execution_price: px,\r\n        quantity: qty,\r\n        trade_date: new Date().toISOString(),\r\n        commission: 0,\r\n        settlement_date: new Date(),\r\n      });\r\n\r\n      if (tradeError) {\r\n        console.error('Trade insert error:', tradeError);\r\n        setMessage('Order created but trade record failed.');\r\n        return;\r\n      }\r\n\r\n      // 3) update account balance\r\n      const newBalance =\r\n        side === 'BUY'\r\n          ? Number((currentBalance - amt).toFixed(2))\r\n          : Number((currentBalance + amt).toFixed(2));\r\n\r\n      const { error: acctUpdateError } = await supabase\r\n        .from('account')\r\n        .update({ balance: newBalance, available_balance: newBalance })\r\n        .eq('account_id', account.account_id);\r\n\r\n      if (acctUpdateError) {\r\n        console.error('Account update error:', acctUpdateError);\r\n        setMessage('Trade executed but failed to update balance.');\r\n        return;\r\n      }\r\n\r\n      // 4) insert into transaction\r\n      const { error: txError } = await supabase.from('transaction').insert({\r\n        account_id: account.account_id,\r\n        transaction_type: side === 'BUY' ? 'Buy' : 'Sell',\r\n        amount: amt,\r\n        balance_before: currentBalance,\r\n        balance_after: newBalance,\r\n        transaction_date: new Date().toISOString(),\r\n        status: 'COMPLETED',\r\n      });\r\n\r\n      if (txError) {\r\n        console.error('Transaction insert error:', txError);\r\n      }\r\n\r\n      // 5) ðŸ”¹ UPDATE / INSERT INTO position TABLE\r\n      await upsertPositionRow(\r\n        account.account_id,\r\n        stock.ticker_id,\r\n        side,\r\n        qty,\r\n        px\r\n      );\r\n\r\n      // update local account + portfolio + UI orders (still tracked client-side)\r\n      setAccount((prev) => (prev ? { ...prev, balance: newBalance } : prev));\r\n      updatePortfolio(newBalance, s, px, side === 'BUY' ? qty : -qty);\r\n\r\n      const uiOrder: UiOrder = {\r\n        id: (orderRow as any).order_id.toString(),\r\n        time: (orderRow as any).order_date,\r\n        symbol: s,\r\n        side,\r\n        type: ORDER_TYPE,\r\n        qty,\r\n        fillPrice: px,\r\n      };\r\n\r\n      const nextOrders = [uiOrder, ...orders].slice(0, 100);\r\n      setOrders(nextOrders);\r\n      writeJSON('demo_orders', nextOrders);\r\n\r\n      setMessage(`${side} ${qty} ${s} @ ${fmt(px)} filled.`);\r\n      router.refresh(); // refresh navbar balance, etc.\r\n    } catch (err) {\r\n      console.error(err);\r\n      setMessage('Unexpected error while placing order.');\r\n    }\r\n  }\r\n\r\n  const est = (quote ?? 0) * qty;\r\n  const canSubmit =\r\n    !!symbol &&\r\n    Number.isFinite(qty) &&\r\n    qty > 0 &&\r\n    quote != null &&\r\n    quote > 0 &&\r\n    !quoteLoading;\r\n\r\n  // render gates\r\n  if (!mounted) return null;\r\n  if (!authed) return null;\r\n\r\n  if (loading) {\r\n    return (\r\n      <main\r\n        className=\"trade container\"\r\n        style={{ paddingTop: 24, paddingBottom: 24 }}\r\n      >\r\n        <p>Loading trading data...</p>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  if (loadError || !account) {\r\n    return (\r\n      <main\r\n        className=\"trade container\"\r\n        style={{ paddingTop: 24, paddingBottom: 24 }}\r\n      >\r\n        <p className=\"trade__alert is-error\">\r\n          {loadError ?? 'No trading account found.'}\r\n        </p>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main\r\n      className=\"trade container\"\r\n      style={{ paddingTop: 24, paddingBottom: 24 }}\r\n    >\r\n      <div className=\"pageheader\">\r\n        <div>\r\n          <h1 className=\"stocks__title\">Trade</h1>\r\n          <p className=\"stocks__sub\">Buy or sell stocks with ease.</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Wrapper that applies disabled state + banner when closed */}\r\n      <div className={isClosed ? 'trade-disabled' : ''}>\r\n        {isClosed && (\r\n          <div className=\"market-closed-banner\">\r\n            {marketStatusMsg ??\r\n              'Trading is currently closed. Please return during normal market hours.'}\r\n          </div>\r\n        )}\r\n\r\n        {/* Ticket */}\r\n        <section\r\n          className=\"card\"\r\n          style={{\r\n            marginBottom: 24,\r\n            background: '#060816',\r\n            borderRadius: 20,\r\n            border: '1px solid rgba(255,255,255,0.05)',\r\n          }}\r\n        >\r\n          <div className=\"pillgroup\" role=\"tablist\" aria-label=\"Order side\">\r\n            <button\r\n              className={`pillbtn ${side === 'BUY' ? 'is-active' : ''}`}\r\n              onClick={() => {\r\n                setSide('BUY');\r\n                setMessage('');\r\n              }}\r\n              type=\"button\"\r\n            >\r\n              Buy\r\n            </button>\r\n            <button\r\n              className={`pillbtn ${side === 'SELL' ? 'is-active' : ''}`}\r\n              onClick={() => {\r\n                setSide('SELL');\r\n                setMessage('');\r\n              }}\r\n              type=\"button\"\r\n            >\r\n              Sell\r\n            </button>\r\n          </div>\r\n\r\n          <form\r\n            className=\"auth__form\"\r\n            onSubmit={(e) => {\r\n              e.preventDefault();\r\n              void placeOrder();\r\n            }}\r\n          >\r\n            <div className=\"fieldrow\">\r\n              <label className=\"field\">\r\n                <span className=\"field__label\">Symbol</span>\r\n                <select\r\n                  className=\"field__input\"\r\n                  value={symbol}\r\n                  onChange={(e) => {\r\n                    setSymbol(e.target.value);\r\n                    setMessage('');\r\n                  }}\r\n                  disabled={isClosed}\r\n                >\r\n                  {stocks.length === 0 && (\r\n                    <option value=\"\">No tickers available</option>\r\n                  )}\r\n                  {stocks.map((st) => (\r\n                    <option key={st.ticker_id} value={st.symbol}>\r\n                      {st.company_name\r\n                        ? `${st.symbol} â€” ${st.company_name}`\r\n                        : st.symbol}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </label>\r\n\r\n              <label className=\"field\">\r\n                <span className=\"field__label\">Quantity</span>\r\n                <input\r\n                  className=\"field__input\"\r\n                  type=\"number\"\r\n                  min={1}\r\n                  step={1}\r\n                  value={qty}\r\n                  onChange={(e) => {\r\n                    setQty(Math.max(1, Number(e.target.value)));\r\n                    setMessage('');\r\n                  }}\r\n                  placeholder=\"1\"\r\n                  disabled={isClosed}\r\n                />\r\n              </label>\r\n            </div>\r\n\r\n            <div className=\"fieldrow\">\r\n              <label className=\"field\">\r\n                <span className=\"field__label\">\r\n                  Price (latest close from pricebar)\r\n                </span>\r\n                <input\r\n                  className=\"field__input\"\r\n                  type=\"text\"\r\n                  value={\r\n                    quoteLoading\r\n                      ? 'Loading...'\r\n                      : quote != null\r\n                      ? fmt(quote)\r\n                      : 'No price data'\r\n                  }\r\n                  readOnly\r\n                />\r\n              </label>\r\n            </div>\r\n\r\n            <div className=\"actions-row\">\r\n              <div className=\"badge\">\r\n                Est. {side === 'BUY' ? 'Cost' : 'Proceeds'}:{' '}\r\n                <strong>{fmt(est || 0)}</strong>\r\n              </div>\r\n              <div className=\"badge\">\r\n                Cash: <strong>{fmt(account.balance)}</strong>\r\n              </div>\r\n            </div>\r\n\r\n            {message && (\r\n              <div\r\n                className={`trade__alert ${\r\n                  /filled\\.$/i.test(message) ? 'is-success' : 'is-error'\r\n                }`}\r\n                style={{ marginTop: 6 }}\r\n              >\r\n                {message}\r\n              </div>\r\n            )}\r\n\r\n            <button\r\n              type=\"submit\"\r\n              className=\"btn btn--primary\"\r\n              style={{ width: '100%' }}\r\n              disabled={!canSubmit || stocks.length === 0 || isClosed}\r\n            >\r\n              {side === 'BUY' ? 'Buy' : 'Sell'} {qty}{' '}\r\n              {symbol ? symbol.toUpperCase() : ''}\r\n            </button>\r\n          </form>\r\n        </section>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAkCA,MAAM,gBAAgB;AACtB,MAAM,aAAwB;AAE9B,uBAAuB;AACvB,SAAS,SAAY,GAAW,EAAE,QAAW;IAC3C,IAAI;QACF,OAAO,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,QAAQ,WAAW;IAC5D,EAAE,OAAM;QACN,OAAO;IACT;AACF;AACA,SAAS,UAAU,GAAW,EAAE,KAAc;IAC5C,aAAa,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;AAC3C;AACA,SAAS;IACP,MAAM,IAAI,SAAoB,kBAAkB;QAC9C,MAAM;QACN,WAAW,EAAE;IACf;IACA,IAAI,OAAO,EAAE,IAAI,KAAK,YAAY,CAAC,MAAM,OAAO,CAAC,EAAE,SAAS,GAAG;QAC7D,OAAO;YAAE,MAAM;YAAe,WAAW,EAAE;QAAC;IAC9C;IACA,OAAO;AACT;AACA,MAAM,MAAM,CAAC,IACX,CAAC,CAAC,EAAE,EAAE,cAAc,CAAC,WAAW;QAAE,uBAAuB;IAAE,IAAI;AAEjE,sDAAsD,GACtD,SAAS;IACP,MAAM,MAAM,IAAI;IAChB,MAAM,MAAM,IAAI,KAAK,cAAc,CAAC,SAAS;QAC3C,UAAU;QACV,MAAM;QACN,OAAO;QACP,KAAK;QACL,MAAM;QACN,QAAQ;QACR,QAAQ;QACR,SAAS;QACT,QAAQ;IACV;IAEA,MAAM,QAAQ,IAAI,aAAa,CAAC;IAChC,MAAM,MAA8B,CAAC;IACrC,KAAK,MAAM,KAAK,MAAO;QACrB,IAAI,EAAE,IAAI,KAAK,WAAW,GAAG,CAAC,EAAE,IAAI,CAAC,GAAG,EAAE,KAAK;IACjD;IAEA,MAAM,OAAO,GAAG,IAAI,IAAI,CAAC,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,IAAI,GAAG,EAAE;IAClD,MAAM,OAAO,GAAG,IAAI,IAAI,CAAC,CAAC,EAAE,IAAI,MAAM,CAAC,CAAC,EAAE,IAAI,MAAM,EAAE;IACtD,MAAM,eAAe,IAAI,OAAO,EAAE,qBAAqB;IAEvD,MAAM,aAAqC;QACzC,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;IACP;IAEA,MAAM,YAAY,UAAU,CAAC,aAAa,IAAI;IAC9C,MAAM,OAAO,OAAO,IAAI,IAAI;IAC5B,MAAM,SAAS,OAAO,IAAI,MAAM;IAEhC,OAAO;QAAE;QAAM;QAAM;QAAW;QAAM;IAAO;AAC/C;AAEA,SAAS,cAAc,CAA4B;IACjD,IAAI,CAAC,GAAG,OAAO;IACf,MAAM,CAAC,GAAG,GAAG,EAAE,GAAG,EAAE,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,IAAM,OAAO;IACjD,IAAI,OAAO,KAAK,CAAC,MAAM,OAAO,KAAK,CAAC,IAAI,OAAO;IAC/C,OAAO,IAAI,KAAK,IAAI,CAAC,OAAO,KAAK,CAAC,KAAK,IAAI,IAAI,EAAE;AACnD;AAEA,0CAA0C,GAC1C,eAAe,kBACb,SAAiB,EACjB,QAAgB,EAChB,IAAU,EACV,GAAW,EACX,KAAa;IAEb,IAAI;QACF,8DAA8D;QAC9D,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,MAAM,EAAE,GAAG,MAAM,+IAAQ,CACrD,IAAI,CAAC,YACL,MAAM,CAAC,uCACP,EAAE,CAAC,cAAc,WACjB,EAAE,CAAC,aAAa,UAChB,WAAW;QAEd,IAAI,QAAQ;YACV,QAAQ,KAAK,CAAC,0BAA0B;YACxC;QACF;QAEA,MAAM,SAAS,IAAI,OAAO,WAAW;QAErC,kBAAkB;QAClB,IAAI,CAAC,UAAU;YACb,IAAI,SAAS,QAAQ;gBACnB,kEAAkE;gBAClE,wCAAwC;gBACxC,QAAQ,IAAI,CAAC;gBACb;YACF;YAEA,gCAAgC;YAChC,MAAM,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,+IAAQ,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC;gBAClE,YAAY;gBACZ,WAAW;gBACX,UAAU;gBACV,cAAc;gBACd,eAAe,QAAQ;gBACvB,eAAe;gBACf,aAAa;gBACb,cAAc;YAChB;YAEA,IAAI,WAAW;gBACb,QAAQ,KAAK,CAAC,0BAA0B;YAC1C;YACA;QACF;QAEA,6BAA6B;QAC7B,MAAM,SAAS,OAAO,AAAC,SAAiB,QAAQ,KAAK;QACrD,MAAM,UAAU,OAAO,AAAC,SAAiB,YAAY,KAAK;QAE1D,IAAI,SAAS;QACb,IAAI,aAAa;QAEjB,IAAI,SAAS,OAAO;YAClB,SAAS,SAAS;YAClB,aACE,SAAS,IACL,CAAC,UAAU,SAAS,QAAQ,GAAG,IAAI,SACnC;QACR,OAAO;YACL,OAAO;YACP,SAAS,SAAS;YAClB,IAAI,SAAS,GAAG;gBACd,QAAQ,IAAI,CAAC;gBACb;YACF;QACA,wEAAwE;QAC1E;QAEA,IAAI,WAAW,GAAG;YAChB,qCAAqC;YACrC,MAAM,EAAE,OAAO,MAAM,EAAE,GAAG,MAAM,+IAAQ,CACrC,IAAI,CAAC,YACL,MAAM,GACN,EAAE,CAAC,eAAe,AAAC,SAAiB,WAAW;YAElD,IAAI,QAAQ;gBACV,QAAQ,KAAK,CAAC,0BAA0B;YAC1C;YACA;QACF;QAEA,sBAAsB;QACtB,MAAM,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,+IAAQ,CACxC,IAAI,CAAC,YACL,MAAM,CAAC;YACN,UAAU;YACV,cAAc;YACd,eAAe,SAAS;YACxB,cAAc;QAChB,GACC,EAAE,CAAC,eAAe,AAAC,SAAiB,WAAW;QAElD,IAAI,WAAW;YACb,QAAQ,KAAK,CAAC,0BAA0B;QAC1C;IACF,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,uCAAuC;IACvD;AACF;AAEe,SAAS;IACtB,MAAM,SAAS,IAAA,6JAAS;IACxB,MAAM,EAAE,UAAU,EAAE,GAAG,IAAA,qJAAc;IAErC,qBAAqB;IACrB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+NAAQ,EAAC;IACvC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+NAAQ,EAAiB;IAC7D,IAAA,gOAAS,EAAC;QACR,WAAW;QACX,IAAI;YACF,cAAc,CAAC,CAAC,aAAa,OAAO,CAAC;QACvC,EAAE,OAAM;YACN,cAAc;QAChB;IACF,GAAG,EAAE;IACL,MAAM,SAAS,cAAc,CAAC,CAAC;IAE/B,WAAW;IACX,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+NAAQ,EAAU,EAAE;IAChD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+NAAQ,EAAiB;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+NAAQ,EAAC;IACvC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+NAAQ,EAAgB;IAE1D,QAAQ;IACR,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+NAAQ,EAAgB;IAClD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+NAAQ,EAAC;IAEjD,eAAe;IACf,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+NAAQ,EAAC;IACrC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,+NAAQ,EAAS;IACvC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+NAAQ,EAAO;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+NAAQ,EAAS;IAE/C,8BAA8B;IAC9B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+NAAQ,EAAY;QACpD,MAAM;QACN,WAAW,EAAE;IACf;IACA,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+NAAQ,EAAY,EAAE;IAElD,gCAAgC;IAChC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+NAAQ,EAAU;IAClD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,+NAAQ,EAAgB;IAEtE,6CAA6C;IAC7C,IAAA,gOAAS,EAAC;QACR,IAAI,CAAC,SAAS;QACd,aAAa;QACb,UAAU,SAAoB,eAAe,EAAE;IACjD,GAAG;QAAC;KAAQ;IAEZ,yBAAyB;IACzB,IAAA,gOAAS,EAAC;QACR,IAAI,CAAC,SAAS;QACd,IAAI,CAAC,QAAQ,OAAO,OAAO,CAAC;IAC9B,GAAG;QAAC;QAAS;QAAQ;KAAO;IAE5B,+CAA+C;IAC/C,IAAA,gOAAS,EAAC;QACR,IAAI,CAAC,SAAS;QAEd,MAAM,OAAO;YACX,WAAW;YACX,aAAa;YAEb,6DAA6D;YAC7D,IAAI,aAA4B;YAChC,IAAI,eAA8B;YAElC,IAAI;gBACF,MAAM,MAAM,aAAa,OAAO,CAAC;gBACjC,IAAI,KAAK;oBACP,MAAM,MAAM,KAAK,KAAK,CAAC;oBAEvB,+DAA+D;oBAC/D,IAAI,OAAO,IAAI,OAAO,KAAK,UAAU;wBACnC,aAAa,IAAI,OAAO;oBAC1B,OAAO,IAAI,OAAO,IAAI,EAAE,KAAK,UAAU;wBACrC,aAAa,IAAI,EAAE;oBACrB;oBAEA,sEAAsE;oBACtE,IAAI,OAAO,IAAI,KAAK,KAAK,UAAU;wBACjC,eAAe,IAAI,KAAK;oBAC1B;gBACF;YACF,EAAE,OAAM;YACN,UAAU,GACZ;YAEA,+EAA+E;YAC/E,wCAAwC;YACxC,IAAI,CAAC,cAAc,cAAc;gBAC/B,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,OAAO,EAAE,GAAG,MAAM,+IAAQ,CACrD,IAAI,CAAC,SACL,MAAM,CAAC,WACP,EAAE,CAAC,SAAS,cACZ,WAAW;gBAEd,IAAI,SAAS;oBACX,QAAQ,KAAK,CAAC,yCAAyC;gBACzD,OAAO,IAAI,WAAW,AAAC,QAAgB,OAAO,IAAI,MAAM;oBACtD,aAAa,OAAO,AAAC,QAAgB,OAAO;gBAC9C;YACF;YAEA,IAAI,CAAC,YAAY;gBACf,aACE;gBAEF,WAAW;gBACX;YACF;YAEA,kBAAkB;YAClB,MAAM,EAAE,MAAM,UAAU,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,+IAAQ,CAC5D,IAAI,CAAC,UACL,MAAM,CAAC,mCACP,EAAE,CAAC,aAAa,MAChB,KAAK,CAAC,UAAU;gBAAE,WAAW;YAAK;YAErC,IAAI,aAAa;gBACf,QAAQ,KAAK,CAAC;gBACd,aAAa;YACf,OAAO,IAAI,cAAc,WAAW,MAAM,GAAG,GAAG;gBAC9C,UAAU;gBACV,UAAU,CAAC,OAAS,QAAQ,UAAU,CAAC,EAAE,CAAC,MAAM;YAClD,OAAO;gBACL,UAAU,EAAE;gBACZ,UAAU;YACZ;YAEA,uCAAuC;YACvC,MAAM,EAAE,MAAM,IAAI,EAAE,OAAO,OAAO,EAAE,GAAG,MAAM,+IAAQ,CAClD,IAAI,CAAC,WACL,MAAM,CAAC,uBACP,EAAE,CAAC,WAAW,YACd,WAAW;YAEd,IAAI,WAAW,CAAC,MAAM;gBACpB,QAAQ,KAAK,CAAC;gBACd,aACE;gBAEF,WAAW;gBACX;YACF;YAEA,MAAM,cAAc,OAAO,AAAC,KAAa,OAAO;YAChD,WAAW;gBACT,YAAY,AAAC,KAAa,UAAU;gBACpC,SAAS;YACX;YAEA,aAAa,CAAC,OAAS,CAAC;oBACtB,GAAG,IAAI;oBACP,MAAM;gBACR,CAAC;YAED,WAAW;QACb;QAEA,KAAK;IACP,GAAG;QAAC;KAAQ;IAEZ,0DAA0D;IAC1D,IAAA,gOAAS,EAAC;QACR,MAAM,YAAY;YAChB,IAAI,CAAC,UAAU,OAAO,MAAM,KAAK,GAAG;gBAClC,SAAS;gBACT;YACF;YAEA,MAAM,QAAQ,OAAO,IAAI,CAAC,CAAC,KAAO,GAAG,MAAM,KAAK;YAChD,IAAI,CAAC,OAAO;gBACV,SAAS;gBACT;YACF;YAEA,gBAAgB;YAEhB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,+IAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,4CACP,EAAE,CAAC,aAAa,MAAM,SAAS,EAC/B,EAAE,CAAC,iBAAiB,SACpB,KAAK,CAAC,YAAY;gBAAE,WAAW;YAAM,GACrC,KAAK,CAAC,YAAY;gBAAE,WAAW;YAAM,GACrC,KAAK,CAAC,GACN,WAAW;YAEd,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC;gBACd,SAAS;YACX,OAAO,IAAI,QAAQ,AAAC,KAAa,KAAK,IAAI,MAAM;gBAC9C,SAAS,OAAO,AAAC,KAAa,KAAK;YACrC,OAAO;gBACL,SAAS;YACX;YAEA,gBAAgB;QAClB;QAEA,KAAK;IACP,GAAG;QAAC;QAAQ;KAAO;IAEnB,MAAM,SAAS,IAAA,8NAAO,EAAC;QACrB,MAAM,MAAM,IAAI;QAChB,UAAU,SAAS,CAAC,OAAO,CAAC,CAAC,IAAM,IAAI,GAAG,CAAC,EAAE,MAAM,EAAE;QACrD,OAAO;IACT,GAAG;QAAC,UAAU,SAAS;KAAC;IAExB,yCAAyC,GACzC,IAAA,gOAAS,EAAC;QACR,IAAI,CAAC,SAAS;QAEd,MAAM,cAAc;YAClB,IAAI;gBACF,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG;gBAChD,MAAM,aAAa,OAAO,KAAK;gBAE/B,8BAA8B;gBAC9B,MAAM,EAAE,MAAM,MAAM,EAAE,OAAO,MAAM,EAAE,GAAG,MAAM,+IAAQ,CACnD,IAAI,CAAC,kBACL,MAAM,CAAC,+BACP,EAAE,CAAC,QAAQ,MACX,WAAW;gBAEd,IAAI,QAAQ;oBACV,QAAQ,KAAK,CAAC,gCAAgC;gBAChD;gBAEA,IAAI,UAAU,OAAO,aAAa,KAAK,UAAU;oBAC/C,YAAY;oBACZ,mBACE,OAAO,YAAY,GACf,CAAC,wBAAwB,EAAE,OAAO,YAAY,CAAC,CAAC,CAAC,GACjD;oBAEN;gBACF;gBAEA,0CAA0C;gBAC1C,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,QAAQ,EAAE,GAAG,MAAM,+IAAQ,CACvD,IAAI,CAAC,eACL,MAAM,CACL,uFAED,EAAE,CAAC,eAAe,WAClB,EAAE,CAAC,aAAa,MAChB,GAAG,CAAC,kBAAkB,MACtB,KAAK,CAAC,kBAAkB;oBAAE,WAAW;gBAAM,GAC3C,KAAK,CAAC,GACN,WAAW;gBAEd,IAAI,UAAU;oBACZ,QAAQ,KAAK,CAAC,6BAA6B;oBAC3C,YAAY;oBACZ,mBAAmB;oBACnB;gBACF;gBAEA,IAAI,CAAC,UAAU;oBACb,yBAAyB;oBACzB,YAAY;oBACZ,mBAAmB;oBACnB;gBACF;gBAEA,MAAM,eACJ,cAAc,SAAS,gBAAgB,KACvC,cAAc,SAAS,SAAS;gBAClC,MAAM,aACJ,cAAc,SAAS,eAAe,KACtC,cAAc,SAAS,UAAU;gBAEnC,IACE,gBAAgB,QAChB,cAAc,QACd,aAAa,gBACb,aAAa,YACb;oBACA,YAAY;oBACZ,mBACE;gBAEJ,OAAO;oBACL,YAAY;oBACZ,mBAAmB;gBACrB;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,4BAA4B;gBAC1C,YAAY;gBACZ,mBAAmB;YACrB;QACF;QAEA,KAAK;IACP,GAAG;QAAC;KAAQ;IAEZ,SAAS,gBACP,OAAe,EACf,CAAS,EACT,SAAiB,EACjB,QAAgB;QAEhB,aAAa,CAAC;YACZ,MAAM,OAAkB;gBACtB,MAAM;gBACN,WAAW,KAAK,SAAS,CAAC,GAAG,CAAC,CAAC,IAAM,CAAC;wBAAE,GAAG,CAAC;oBAAC,CAAC;YAChD;YAEA,MAAM,WAAW,KAAK,SAAS,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;YACzD,IAAI,CAAC,UAAU;gBACb,IAAI,WAAW,GAAG;oBAChB,KAAK,SAAS,CAAC,IAAI,CAAC;wBAClB,QAAQ;wBACR,KAAK;wBACL,UAAU;oBACZ;gBACF;YACF,OAAO;gBACL,MAAM,SAAS,SAAS,GAAG,GAAG;gBAC9B,IAAI,UAAU,GAAG;oBACf,KAAK,SAAS,GAAG,KAAK,SAAS,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;gBAC7D,OAAO,IAAI,WAAW,GAAG;oBACvB,SAAS,QAAQ,GACf,CAAC,SAAS,QAAQ,GAAG,SAAS,GAAG,GAAG,YAAY,QAAQ,IAAI;oBAC9D,SAAS,GAAG,GAAG;gBACjB,OAAO;oBACL,SAAS,GAAG,GAAG;gBACjB;YACF;YAEA,UAAU,kBAAkB;YAC5B,OAAO;QACT;IACF;IAEA,eAAe;QACb,IAAI,CAAC,SAAS;YACZ,WAAW;YACX;QACF;QAEA,IAAI,UAAU;YACZ,WACE,mBACE;YAEJ;QACF;QAEA,MAAM,IAAI,OAAO,IAAI,GAAG,WAAW;QACnC,IAAI,CAAC,GAAG;YACN,WAAW;YACX;QACF;QACA,IAAI,CAAC,OAAO,QAAQ,CAAC,QAAQ,OAAO,GAAG;YACrC,WAAW;YACX;QACF;QACA,IAAI,SAAS,QAAQ,CAAC,OAAO,QAAQ,CAAC,UAAU,SAAS,GAAG;YAC1D,WAAW;YACX;QACF;QAEA,MAAM,QAAQ,OAAO,IAAI,CAAC,CAAC,KAAO,GAAG,MAAM,KAAK;QAChD,IAAI,CAAC,OAAO;YACV,WAAW;YACX;QACF;QAEA,MAAM,KAAK;QACX,MAAM,MAAM,OAAO,CAAC,KAAK,GAAG,EAAE,OAAO,CAAC;QACtC,MAAM,iBAAiB,OAAO,QAAQ,OAAO;QAE7C,IAAI,SAAS,SAAS,MAAM,gBAAgB;YAC1C,WAAW,CAAC,6BAA6B,EAAE,IAAI,gBAAgB,CAAC,CAAC;YACjE;QACF;QAEA,IAAI,SAAS,QAAQ;YACnB,MAAM,OAAO,OAAO,GAAG,CAAC,IAAI,OAAO;YACnC,IAAI,MAAM,MAAM;gBACd,WAAW,CAAC,cAAc,EAAE,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC;gBAChD;YACF;QACF;QAEA,IAAI;YACF,WAAW;YAEX,wBAAwB;YACxB,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,+IAAQ,CACzD,IAAI,CAAC,UACL,MAAM,CAAC;gBACN,YAAY,QAAQ,UAAU;gBAC9B,WAAW,MAAM,SAAS;gBAC1B,YAAY;gBACZ,MAAM,SAAS,QAAQ,QAAQ;gBAC/B,UAAU;gBACV,OAAO;gBACP,QAAQ;gBACR,YAAY,IAAI,OAAO,WAAW;YACpC,GACC,MAAM,GACN,MAAM;YAET,IAAI,cAAc,CAAC,UAAU;gBAC3B,QAAQ,KAAK,CAAC,uBAAuB;gBACrC,WACE,CAAC,uBAAuB,EAAE,YAAY,WAAW,iBAAiB;gBAEpE;YACF;YAEA,uBAAuB;YACvB,MAAM,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,+IAAQ,CAAC,IAAI,CAAC,SAAS,MAAM,CAAC;gBAChE,UAAU,AAAC,SAAiB,QAAQ;gBACpC,WAAW,MAAM,SAAS;gBAC1B,iBAAiB;gBACjB,UAAU;gBACV,YAAY,IAAI,OAAO,WAAW;gBAClC,YAAY;gBACZ,iBAAiB,IAAI;YACvB;YAEA,IAAI,YAAY;gBACd,QAAQ,KAAK,CAAC,uBAAuB;gBACrC,WAAW;gBACX;YACF;YAEA,4BAA4B;YAC5B,MAAM,aACJ,SAAS,QACL,OAAO,CAAC,iBAAiB,GAAG,EAAE,OAAO,CAAC,MACtC,OAAO,CAAC,iBAAiB,GAAG,EAAE,OAAO,CAAC;YAE5C,MAAM,EAAE,OAAO,eAAe,EAAE,GAAG,MAAM,+IAAQ,CAC9C,IAAI,CAAC,WACL,MAAM,CAAC;gBAAE,SAAS;gBAAY,mBAAmB;YAAW,GAC5D,EAAE,CAAC,cAAc,QAAQ,UAAU;YAEtC,IAAI,iBAAiB;gBACnB,QAAQ,KAAK,CAAC,yBAAyB;gBACvC,WAAW;gBACX;YACF;YAEA,6BAA6B;YAC7B,MAAM,EAAE,OAAO,OAAO,EAAE,GAAG,MAAM,+IAAQ,CAAC,IAAI,CAAC,eAAe,MAAM,CAAC;gBACnE,YAAY,QAAQ,UAAU;gBAC9B,kBAAkB,SAAS,QAAQ,QAAQ;gBAC3C,QAAQ;gBACR,gBAAgB;gBAChB,eAAe;gBACf,kBAAkB,IAAI,OAAO,WAAW;gBACxC,QAAQ;YACV;YAEA,IAAI,SAAS;gBACX,QAAQ,KAAK,CAAC,6BAA6B;YAC7C;YAEA,4CAA4C;YAC5C,MAAM,kBACJ,QAAQ,UAAU,EAClB,MAAM,SAAS,EACf,MACA,KACA;YAGF,2EAA2E;YAC3E,WAAW,CAAC,OAAU,OAAO;oBAAE,GAAG,IAAI;oBAAE,SAAS;gBAAW,IAAI;YAChE,gBAAgB,YAAY,GAAG,IAAI,SAAS,QAAQ,MAAM,CAAC;YAE3D,MAAM,UAAmB;gBACvB,IAAI,AAAC,SAAiB,QAAQ,CAAC,QAAQ;gBACvC,MAAM,AAAC,SAAiB,UAAU;gBAClC,QAAQ;gBACR;gBACA,MAAM;gBACN;gBACA,WAAW;YACb;YAEA,MAAM,aAAa;gBAAC;mBAAY;aAAO,CAAC,KAAK,CAAC,GAAG;YACjD,UAAU;YACV,UAAU,eAAe;YAEzB,WAAW,GAAG,KAAK,CAAC,EAAE,IAAI,CAAC,EAAE,EAAE,GAAG,EAAE,IAAI,IAAI,QAAQ,CAAC;YACrD,OAAO,OAAO,IAAI,+BAA+B;QACnD,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;YACd,WAAW;QACb;IACF;IAEA,MAAM,MAAM,CAAC,SAAS,CAAC,IAAI;IAC3B,MAAM,YACJ,CAAC,CAAC,UACF,OAAO,QAAQ,CAAC,QAChB,MAAM,KACN,SAAS,QACT,QAAQ,KACR,CAAC;IAEH,eAAe;IACf,IAAI,CAAC,SAAS,OAAO;IACrB,IAAI,CAAC,QAAQ,OAAO;IAEpB,IAAI,SAAS;QACX,qBACE,4PAAC;YACC,WAAU;YACV,OAAO;gBAAE,YAAY;gBAAI,eAAe;YAAG;sBAE3C,cAAA,4PAAC;0BAAE;;;;;;;;;;;IAGT;IAEA,IAAI,aAAa,CAAC,SAAS;QACzB,qBACE,4PAAC;YACC,WAAU;YACV,OAAO;gBAAE,YAAY;gBAAI,eAAe;YAAG;sBAE3C,cAAA,4PAAC;gBAAE,WAAU;0BACV,aAAa;;;;;;;;;;;IAItB;IAEA,qBACE,4PAAC;QACC,WAAU;QACV,OAAO;YAAE,YAAY;YAAI,eAAe;QAAG;;0BAE3C,4PAAC;gBAAI,WAAU;0BACb,cAAA,4PAAC;;sCACC,4PAAC;4BAAG,WAAU;sCAAgB;;;;;;sCAC9B,4PAAC;4BAAE,WAAU;sCAAc;;;;;;;;;;;;;;;;;0BAK/B,4PAAC;gBAAI,WAAW,WAAW,mBAAmB;;oBAC3C,0BACC,4PAAC;wBAAI,WAAU;kCACZ,mBACC;;;;;;kCAKN,4PAAC;wBACC,WAAU;wBACV,OAAO;4BACL,cAAc;4BACd,YAAY;4BACZ,cAAc;4BACd,QAAQ;wBACV;;0CAEA,4PAAC;gCAAI,WAAU;gCAAY,MAAK;gCAAU,cAAW;;kDACnD,4PAAC;wCACC,WAAW,CAAC,QAAQ,EAAE,SAAS,QAAQ,cAAc,IAAI;wCACzD,SAAS;4CACP,QAAQ;4CACR,WAAW;wCACb;wCACA,MAAK;kDACN;;;;;;kDAGD,4PAAC;wCACC,WAAW,CAAC,QAAQ,EAAE,SAAS,SAAS,cAAc,IAAI;wCAC1D,SAAS;4CACP,QAAQ;4CACR,WAAW;wCACb;wCACA,MAAK;kDACN;;;;;;;;;;;;0CAKH,4PAAC;gCACC,WAAU;gCACV,UAAU,CAAC;oCACT,EAAE,cAAc;oCAChB,KAAK;gCACP;;kDAEA,4PAAC;wCAAI,WAAU;;0DACb,4PAAC;gDAAM,WAAU;;kEACf,4PAAC;wDAAK,WAAU;kEAAe;;;;;;kEAC/B,4PAAC;wDACC,WAAU;wDACV,OAAO;wDACP,UAAU,CAAC;4DACT,UAAU,EAAE,MAAM,CAAC,KAAK;4DACxB,WAAW;wDACb;wDACA,UAAU;;4DAET,OAAO,MAAM,KAAK,mBACjB,4PAAC;gEAAO,OAAM;0EAAG;;;;;;4DAElB,OAAO,GAAG,CAAC,CAAC,mBACX,4PAAC;oEAA0B,OAAO,GAAG,MAAM;8EACxC,GAAG,YAAY,GACZ,GAAG,GAAG,MAAM,CAAC,GAAG,EAAE,GAAG,YAAY,EAAE,GACnC,GAAG,MAAM;mEAHF,GAAG,SAAS;;;;;;;;;;;;;;;;;0DAS/B,4PAAC;gDAAM,WAAU;;kEACf,4PAAC;wDAAK,WAAU;kEAAe;;;;;;kEAC/B,4PAAC;wDACC,WAAU;wDACV,MAAK;wDACL,KAAK;wDACL,MAAM;wDACN,OAAO;wDACP,UAAU,CAAC;4DACT,OAAO,KAAK,GAAG,CAAC,GAAG,OAAO,EAAE,MAAM,CAAC,KAAK;4DACxC,WAAW;wDACb;wDACA,aAAY;wDACZ,UAAU;;;;;;;;;;;;;;;;;;kDAKhB,4PAAC;wCAAI,WAAU;kDACb,cAAA,4PAAC;4CAAM,WAAU;;8DACf,4PAAC;oDAAK,WAAU;8DAAe;;;;;;8DAG/B,4PAAC;oDACC,WAAU;oDACV,MAAK;oDACL,OACE,eACI,eACA,SAAS,OACT,IAAI,SACJ;oDAEN,QAAQ;;;;;;;;;;;;;;;;;kDAKd,4PAAC;wCAAI,WAAU;;0DACb,4PAAC;gDAAI,WAAU;;oDAAQ;oDACf,SAAS,QAAQ,SAAS;oDAAW;oDAAE;kEAC7C,4PAAC;kEAAQ,IAAI,OAAO;;;;;;;;;;;;0DAEtB,4PAAC;gDAAI,WAAU;;oDAAQ;kEACf,4PAAC;kEAAQ,IAAI,QAAQ,OAAO;;;;;;;;;;;;;;;;;;oCAIrC,yBACC,4PAAC;wCACC,WAAW,CAAC,aAAa,EACvB,aAAa,IAAI,CAAC,WAAW,eAAe,YAC5C;wCACF,OAAO;4CAAE,WAAW;wCAAE;kDAErB;;;;;;kDAIL,4PAAC;wCACC,MAAK;wCACL,WAAU;wCACV,OAAO;4CAAE,OAAO;wCAAO;wCACvB,UAAU,CAAC,aAAa,OAAO,MAAM,KAAK,KAAK;;4CAE9C,SAAS,QAAQ,QAAQ;4CAAO;4CAAE;4CAAK;4CACvC,SAAS,OAAO,WAAW,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO/C","debugId":null}}]
}